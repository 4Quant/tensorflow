<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../tf-event-dashboard/tf-run-selector.html">
<link rel="import" href="../tf-event-dashboard/tf-x-type-selector.html">
<link rel="import" href="../tf-event-dashboard/tf-color-scale.html">
<link rel="import" href="../tf-dashboard-common/tf-dashboard-layout.html">
<link rel="import" href="../tf-dashboard-common/dashboard-style.html">
<link rel="import" href="../tf-dashboard-common/warning-style.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../tf-imports/lodash.html">
<script src="../../lib/js/requestManager/requestManager.js"></script>
<script src="../../lib/js/backend/urlPathHelpers.js"></script>
<script src="../../lib/js/backend/backend.js"></script>
<script src="main.js"></script>


<!--
tf-compressed-histogram-dashboard is a complete frontend that loads runs from a backend,
and creates chart panes that display data for those runs.

It provides a categorizer, run selector, and x type selector, by which the user
can customize how data is organized and displayed.

Each chart has a button that can toggle whether it is "selected"; selectedRuns
charts are larger.

Organizationally, the #plumbing div contains components that have no concrete
manifestation and just effect data bindings or data loading. The #sidebar contains
shared controls like the tf-categorizer, tf-run-selector, and tf-x-type-selector.
The #center div contains tf-charts embedded inside tf-collapsable-panes.
-->
<dom-module id="tf-histogram-dashboard">
  <template>

    <tf-dashboard-layout>
      <div class="sidebar">
        <div class="sidebar-section">
          <tf-x-type-selector
            id="xTypeSelector"
            out-x-type="{{xType}}"
          ></tf-x-type-selector>
        </div>
        <div class="sidebar-section">
          <tf-run-selector
            id="runSelector"
            runs="[[_runs]]"
            class-scale="[[classScale]]"
            out-selected="{{selectedRuns}}"
            tooltips="[[tooltipMap]]"
            closest-run="[[closestRun]]"
            x-value="[[tooltipXValue]]"
            x-type="[[xType]]"
          ></tf-run-selector>
          </div>
      </div>

      <div class="center">
        <template is="dom-if" if="[[!categories.length]]">
          <div class="warning">
            <p>
              No histogram tags were found.
            </p>
            <p>
              Maybe data hasn't loaded yet, or maybe you need
              to add some <code>tf.histogram_summary</code> ops to your graph, and
              serialize them using the <code>tf.training.summary_io.SummaryWriter</code>.
            </p>
          </div>
        </template>
        <div id="container"></div>
      </div>
    </tf-dashboard-layout>

    <template is="dom-repeat" items="[[hcats]]">
      <div class="category">
        <h3>[[item.name]]</h3>
        <template is="dom-repeat" items="[[item.runTags]]">
          <div class="chart">
            <p>[[item.run]]</p>
            <p>[[item.tag]]</p>
          </div>
        </template>
      </div>
    </template>

    <style include="dashboard-style"></style>
    <style include="warning-style"></style>
  </template>

  <script>
    Polymer({
      is: "tf-histogram-dashboard",
      properties: {},
      ready: function() {
        makeHistogramDashboard(this.$.container, this);
      }
    });
  </script>
</dom-module>
